# JavaScript åŸºåº§æ¶æ„æ–‡æ¡£

## ğŸ“š æ¦‚è¿°

æœ¬é¡¹ç›®é‡‡ç”¨**åŸºåº§ + ä¸šåŠ¡**åˆ†å±‚æ¶æ„,å°†å¯å¤ç”¨çš„æ ¸å¿ƒåŠŸèƒ½æŠ½è±¡ä¸º"åŸºåº§å±‚",ä¸šåŠ¡å¼€å‘æ—¶åªéœ€è°ƒç”¨åŸºåº§ API,ç»„åˆå‡ºå…·ä½“é¡µé¢ã€‚

```
åŸºåº§å±‚ (Foundation APIs)  â†’  æä¾›å¯å¤ç”¨çš„"ç§¯æœ¨"
    â†“
ä¸šåŠ¡å±‚ (Business Logic)   â†’  ç»„åˆç§¯æœ¨,å®ç°å…·ä½“éœ€æ±‚
    â†“
é¡µé¢å±‚ (Page Rendering)   â†’  æœ€ç»ˆäº¤ä»˜çš„äº§å“
```

---

## ğŸ—ï¸ æ–‡ä»¶ç»“æ„

```
js/
â”œâ”€â”€ core/
â”‚   â”œâ”€â”€ dom.js              # DOM å¼•ç”¨ç¼“å­˜
â”‚   â””â”€â”€ app.js              # åº”ç”¨åˆå§‹åŒ–ã€å…¨å±€äº‹ä»¶ç»‘å®š
â”‚
â”œâ”€â”€ layout-system.js        # å¸ƒå±€æ¸²æŸ“ç³»ç»Ÿ (æ ¸å¿ƒåŸºåº§)
â”œâ”€â”€ module-factory.js       # å†…å®¹æ¨¡å—ç”Ÿæˆå™¨
â”œâ”€â”€ navigation.js           # å¯¼èˆªé€»è¾‘ (L1/L2/L3)
â””â”€â”€ main.js                 # åº”ç”¨å…¥å£
```

---

## ğŸ¯ åŸºåº§ API æ–‡æ¡£

### 1. å¸ƒå±€æ¸²æŸ“ç³»ç»Ÿ (`layout-system.js`)

#### `renderLayout(layoutType, data)`
ä¸»å¸ƒå±€æ¸²æŸ“å™¨,æ ¹æ®å¸ƒå±€ç±»å‹ç”Ÿæˆå¯¹åº”çš„ HTML ç»“æ„ã€‚

**å‚æ•°:**
- `layoutType` (string): å¸ƒå±€ç±»å‹
  - `'layout-a'`: å·¦å³éå¯¹ç§°å¤§å± (12åˆ—ç½‘æ ¼, 4:8æ¯”ä¾‹)
  - `'layout-b'`: å‚ç›´å †å æµ (å•åˆ—å¸ƒå±€)
  - `'layout-c'`: é¡¶éƒ¨æ +ç”»å¸ƒå¡«å……
  - `'layout-d'`: è¯¦æƒ…å¼¹çª—å¸ƒå±€ (3åˆ—ç½‘æ ¼, 2:1æ¯”ä¾‹)
- `data` (Array|Object): å¸ƒå±€æ•°æ®,æ ¼å¼å› å¸ƒå±€ç±»å‹è€Œå¼‚

**è¿”å›:** HTML å­—ç¬¦ä¸²

**ç¤ºä¾‹:**
```javascript
// Layout-A: å·¦å³éå¯¹ç§°
const modules = [
    createModule('å·¦ä¾§æ ‡é¢˜', 'å·¦ä¾§å†…å®¹'),
    createModule('å³ä¸Š1', 'å†…å®¹'),
    createModule('å³ä¸Š2', 'å†…å®¹')
];
const html = renderLayout('layout-a', modules);

// Layout-B: å‚ç›´å †å 
const modules = [
    createModule('æ¨¡å—1', 'å†…å®¹1'),
    createModule('æ¨¡å—2', 'å†…å®¹2')
];
const html = renderLayout('layout-b', modules);

// Layout-C: é¡¶éƒ¨æ +ç”»å¸ƒ
const config = {
    toolbar: '<button>æ–°å¢</button>',
    canvas: '<div>ä¸»ä½“å†…å®¹</div>'
};
const html = renderLayout('layout-c', config);
```

---

#### `renderLayoutA(modules)`
æ¸²æŸ“ Layout-A (å·¦å³éå¯¹ç§°å¤§å±)ã€‚

**å‚æ•°:**
- `modules` (Array): æ¨¡å—æ•°ç»„,æœ€å¤š 5 ä¸ªå…ƒç´ 
  - `modules[0]`: å·¦ä¾§çª„æ å†…å®¹
  - `modules[1]`: å³ä¾§é¡¶éƒ¨ç¬¬1ä¸ªå¡ç‰‡
  - `modules[2]`: å³ä¾§é¡¶éƒ¨ç¬¬2ä¸ªå¡ç‰‡
  - `modules[3]`: å³ä¾§ä¸­éƒ¨é€šæ  (å¯é€‰)
  - `modules[4]`: å³ä¾§åº•éƒ¨é€šæ  (å¯é€‰)

**å¸ƒå±€ç»“æ„:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         â”‚  [1]  â”‚  [2]    â”‚
â”‚   [0]   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         â”‚      [3]        â”‚
â”‚         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         â”‚      [4]        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  4åˆ—         8åˆ—
```

---

#### `renderLayoutB(modules)`
æ¸²æŸ“ Layout-B (å‚ç›´å †å æµ)ã€‚

**å‚æ•°:**
- `modules` (Array): æ¨¡å—æ•°ç»„,æ•°é‡ä¸é™

**å¸ƒå±€ç»“æ„:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Module 1      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚     Module 2      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚     Module 3      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

#### `renderLayoutC(config)`
æ¸²æŸ“ Layout-C (é¡¶éƒ¨æ +ç”»å¸ƒå¡«å……)ã€‚

**å‚æ•°:**
- `config` (Object):
  - `toolbar` (string): é¡¶éƒ¨å·¥å…·æ  HTML
  - `canvas` (string): ä¸»ä½“ç”»å¸ƒ HTML

**å¸ƒå±€ç»“æ„:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Toolbar       â”‚ â† å›ºå®šé«˜åº¦ 64px
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                   â”‚
â”‚      Canvas       â”‚ â† flex-1 å¡«å……
â”‚                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

#### `renderLayoutD(modules)`
æ¸²æŸ“ Layout-D (è¯¦æƒ…å¼¹çª—å¸ƒå±€)ã€‚

**å‚æ•°:**
- `modules` (Array): æ¨¡å—æ•°ç»„
  - `modules[0-1]`: å·¦ä¾§ä¸»å†…å®¹åŒº (2ä¸ªæ¨¡å—)
  - `modules[2+]`: å³ä¾§è¾…åŠ©ä¿¡æ¯åŒº (å¤šä¸ªæ¨¡å—)

**å¸ƒå±€ç»“æ„:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”
â”‚   Main 1    â”‚ S1  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”€â”€â”€â”€â”€â”¤
â”‚   Main 2    â”‚ S2  â”‚
â”‚             â”œâ”€â”€â”€â”€â”€â”¤
â”‚             â”‚ S3  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜
    2/3         1/3
```

---

### 2. æ¨¡å—å·¥å‚ (`module-factory.js`)

#### `createModule(title, content, status = 'default')`
åˆ›å»ºæ ‡å‡†å†…å®¹æ¨¡å—,æ”¯æŒçŠ¶æ€å˜ä½“ã€‚

**å‚æ•°:**
- `title` (string): æ¨¡å—æ ‡é¢˜
- `content` (string): æ¨¡å—å†…å®¹ (HTML å­—ç¬¦ä¸²)
- `status` (string): çŠ¶æ€æ ‡è¯†
  - `'default'`: é»˜è®¤çŠ¶æ€ (æ— è¾¹æ¡†)
  - `'added'`: æ–°å¢çŠ¶æ€ (ç»¿è‰²å·¦è¾¹æ¡† #29AC68)
  - `'deleted'`: åˆ é™¤çŠ¶æ€ (çº¢è‰²å·¦è¾¹æ¡† #E38585, ç°è‰²åˆ é™¤çº¿æ ‡é¢˜)

**è¿”å›:** HTML å­—ç¬¦ä¸²

**ç¤ºä¾‹:**
```javascript
// é»˜è®¤æ¨¡å—
const module1 = createModule('æ ‡é¢˜', '<p>å†…å®¹</p>');

// æ–°å¢çŠ¶æ€
const module2 = createModule('æ–°å¢é¡¹', '<p>å†…å®¹</p>', 'added');

// åˆ é™¤çŠ¶æ€
const module3 = createModule('åˆ é™¤é¡¹', '<p>å†…å®¹</p>', 'deleted');
```

**ç”Ÿæˆçš„ HTML ç»“æ„:**
```html
<div class="bg-white rounded-md shadow-[...] overflow-hidden [border-l-4]">
    <div class="p-6 flex flex-col gap-4">
        <div class="border-b border-gray-100 pb-3">
            <h2 class="text-lg font-medium [color]">æ ‡é¢˜</h2>
        </div>
        <div class="flex-1 text-sm text-gray-600">
            å†…å®¹
        </div>
    </div>
</div>
```

---

### 3. DOM å¼•ç”¨ (`core/dom.js`)

#### `DOM` å¯¹è±¡
å…¨å±€ DOM å…ƒç´ å¼•ç”¨ç¼“å­˜,é¿å…é‡å¤æŸ¥è¯¢ã€‚

**ç»“æ„:**
```javascript
const DOM = {
    views: {
        workbench: null,      // å·¥ä½œå°å®¹å™¨
        l2Sidebar: null,      // L2 ä¾§è¾¹æ 
        l3Sidebar: null,      // L3 ä¾§è¾¹æ 
        header: null,         // é¡¶éƒ¨æ 
        mainContent: null,    // ä¸»å†…å®¹åŒº
        footer: null          // åº•éƒ¨æ 
    }
};
```

**ä½¿ç”¨:**
```javascript
// æ›´æ–°ä¸»å†…å®¹åŒº
DOM.views.mainContent.innerHTML = renderLayout('layout-b', modules);
```

---

## ğŸ“– ä½¿ç”¨ç¤ºä¾‹

### å®Œæ•´é¡µé¢å¼€å‘æµç¨‹

```javascript
// 1. å‡†å¤‡æ•°æ®
function prepareAccountingConfigData() {
    return [
        createModule('é…ç½®é¢æ¿', '<ul><li>å‚æ•°1</li><li>å‚æ•°2</li></ul>'),
        createModule('æ–°å¢é…ç½®', '<p>æ–°å¢çš„é…ç½®é¡¹</p>', 'added'),
        createModule('åˆ é™¤é…ç½®', '<p>å·²åˆ é™¤çš„é…ç½®é¡¹</p>', 'deleted'),
        createModule('è®¡ç®—ç»“æœ', '<p>ç»“æœå±•ç¤º</p>')
    ];
}

// 2. æ¸²æŸ“é¡µé¢
function renderAccountingConfigPage() {
    const modules = prepareAccountingConfigData();
    const html = renderLayout('layout-a', modules);
    
    DOM.views.mainContent.innerHTML = html;
    
    // 3. é‡æ–°åˆå§‹åŒ–å›¾æ ‡
    if (typeof lucide !== 'undefined') {
        lucide.createIcons();
    }
}
```

---

## ğŸ¨ è®¾è®¡è§„èŒƒ

### ç»Ÿä¸€é—´è·æ ‡å‡†
- **é¡µé¢ä¸å†…å®¹åŒºé—´è·**: 12px (`p-3`)
- **æ¨¡å—ä¹‹é—´é—´è·**: 12px (`gap-3`)
- **æ‰€æœ‰å¸ƒå±€ç»Ÿä¸€ä½¿ç”¨**: `gap-3`

### é¢œè‰²è§„èŒƒ
- **æ–°å¢çŠ¶æ€**: ç»¿è‰² `#29AC68`
- **åˆ é™¤çŠ¶æ€**: çº¢è‰²è¾¹æ¡† `#E38585`, ç°è‰²æ–‡å­— `#C6C6C6`
- **ä¸»é¢˜è‰²**: Cyan `#087F9C`

---

## ğŸš€ æ‰©å±•æŒ‡å—

### æ·»åŠ æ–°å¸ƒå±€ç±»å‹

1. åœ¨ `layout-system.js` ä¸­æ·»åŠ æ¸²æŸ“å‡½æ•°:
```javascript
function renderLayoutE(data) {
    return `<div class="custom-layout">...</div>`;
}
```

2. åœ¨ `renderLayout()` ä¸­æ³¨å†Œ:
```javascript
case 'layout-e':
    return renderLayoutE(data);
```

3. æ›´æ–°æœ¬æ–‡æ¡£,æ·»åŠ  API è¯´æ˜

### æ·»åŠ æ–°æ¨¡å—å˜ä½“

åœ¨ `createModule()` ä¸­æ‰©å±• `statusStyles`:
```javascript
const statusStyles = {
    'warning': 'border-l-4 border-yellow-500'
};
```

---

## ğŸ“ æœ€ä½³å®è·µ

1. **ä¼˜å…ˆä½¿ç”¨åŸºåº§ API**: ä¸è¦æ‰‹å†™å¸ƒå±€ HTML,è°ƒç”¨ `renderLayout()`
2. **ä¿æŒæ•°æ®ä¸è§†å›¾åˆ†ç¦»**: å…ˆå‡†å¤‡æ•°æ®,å†æ¸²æŸ“è§†å›¾
3. **ç»Ÿä¸€é—´è·**: ä½¿ç”¨ `gap-3` å’Œ `p-3`,ä¸è¦è‡ªå®šä¹‰é—´è·
4. **çŠ¶æ€ç®¡ç†**: ä½¿ç”¨ `createModule()` çš„ status å‚æ•°,ä¸è¦æ‰‹åŠ¨æ·»åŠ æ ·å¼ç±»

---

**æœ€åæ›´æ–°**: 2026-02-01  
**ç»´æŠ¤è€…**: Cyacle Team
